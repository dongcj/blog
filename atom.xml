<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Krrish</title>
  
  <subtitle>Premature optimization is the root of all evil.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.dongcj.com/"/>
  <updated>2018-02-07T08:34:46.277Z</updated>
  <id>http://blog.dongcj.com/</id>
  
  <author>
    <name>Krrish</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>修改 Npm 安装源为国内源</title>
    <link href="http://blog.dongcj.com/m/%E4%BF%AE%E6%94%B9npm%E5%AE%89%E8%A3%85%E6%BA%90%E4%B8%BA%E5%9B%BD%E5%86%85%E6%BA%90/"/>
    <id>http://blog.dongcj.com/m/修改npm安装源为国内源/</id>
    <published>2018-02-07T08:34:46.276Z</published>
    <updated>2018-02-07T08:34:46.277Z</updated>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;淘宝源地址：&lt;a href=&quot;http://npm.taobao.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://npm.taobao.org/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;删除已有-npm-包-可选&quot;&gt;&lt;a href=&quot;#删除已有-npm-包-可选&quot; class=&quot;headerlink&quot; title=&quot;删除已有 npm 包 ( 可选 )&quot;&gt;&lt;/a&gt;删除已有 npm 包 ( 可选 )&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看已安装的 npm package&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm -g ls        &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## 删除所有 npm&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm ls -gp | awk -F/ &lt;span class=&quot;string&quot;&gt;&#39;/node_modules/ &amp;amp;&amp;amp; !/node_modules.*node_modules/ &amp;#123;print $NF&amp;#125;&#39;&lt;/span&gt; | xargs npm -g rm&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;npm ls -g 如果报错，可以进行以下处理 :&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# （原因是 node-modules 中不允许用软链接，但 inherits 却用了）：&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm ERR! missing: inherits@*, required by undefined@undefined&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm ERR! missing: inherits@*, required by block-stream@0.0.7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm ERR! missing: inherits@*, required by fstream@0.1.24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /usr/lib/node_modules/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;unlink inherit&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mv inherits@2/ inherits/&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;npm update npm -g &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; registry=https://registry.npm.taobao.org&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm config &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; ca &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm install npm -g &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; registry=https://registry.npm.taobao.org&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm config delete ca&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;或者做个-cnpm-的-alias&quot;&gt;&lt;a href=&quot;#或者做个-cnpm-的-alias&quot; class=&quot;headerlink&quot; title=&quot;或者做个 cnpm 的 alias&quot;&gt;&lt;/a&gt;或者做个 cnpm 的 alias&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install cnpm&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm install -g cnpm --registry=https://registry.npm.taobao.org&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make alias&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;alias&lt;/span&gt; cnpm=&lt;span class=&quot;string&quot;&gt;&quot;npm --registry=https://registry.npm.taobao.org \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;--cache=&lt;span class=&quot;variable&quot;&gt;$HOME&lt;/span&gt;/.npm/.cache/cnpm \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;--disturl=https://npm.taobao.org/dist \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;--userconfig=&lt;span class=&quot;variable&quot;&gt;$HOME&lt;/span&gt;/.cnpmrc&quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Or alias it in .bashrc or .zshrc&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;\n#alias for cnpm\nalias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  --cache=$HOME/.npm/.cache/cnpm \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  --disturl=https://npm.taobao.org/dist \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  --userconfig=$HOME/.cnpmrc&quot;&#39; &amp;gt;&amp;gt; ~/.zshrc &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.zshrc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install module / sync / info&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cnpm install &amp;lt;NAME&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cnpm sync connect&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cnpm info connect&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Harbor 支持 Https</title>
    <link href="http://blog.dongcj.com/m/Harbor%E6%94%AF%E6%8C%81https/"/>
    <id>http://blog.dongcj.com/m/Harbor支持https/</id>
    <published>2018-02-07T08:34:07.440Z</published>
    <updated>2018-02-07T08:34:07.441Z</updated>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;新建仓库目录&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mkdir -p /opt/svicloud/tools/harbor/data/cert/&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -n &lt;span class=&quot;string&quot;&gt;&quot;svicloud85509336&quot;&lt;/span&gt; &amp;gt;/opt/svicloud/tools/harbor/data/cert/secretkey&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;使用 docker-compose 安装 harbor&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;docker-compose &lt;a href=&quot;http://download.svicloud.com/harbor-docker-compose-v1.2.2.yml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;下载地址&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mv harbor-docker-compose-v1.2.2.yml docker-compose.yml &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;docker-compose up -d&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;测试下，应该可以成功，如无法成功，运行步骤 7&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;（&lt;code&gt;可选&lt;/code&gt;）修改 &lt;code&gt;registry&lt;/code&gt; 中的证书 &lt;code&gt;root.crt&lt;/code&gt; 和 &lt;code&gt;ui&lt;/code&gt; 的 &lt;code&gt;private_key.pem&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;通过-curl-请求测试&quot;&gt;&lt;a href=&quot;#通过-curl-请求测试&quot; class=&quot;headerlink&quot; title=&quot;通过 curl 请求测试&quot;&gt;&lt;/a&gt;通过 curl 请求测试&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;curl -i  https://&amp;lt;HARBOR.DOMAIN.COM&amp;gt;/v2/_catalog&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;HTTP/1.1 401 Unauthorized&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Server: nginx/1.11.5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Date: Fri, 19 May 2017 06:45:06 GMT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Content-Type: application/json; charset=utf-8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Content-Length: 134&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Connection: keep-alive&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Docker-Distribution-Api-Version: registry/2.0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Www-Authenticate: Bearer realm=&lt;span class=&quot;string&quot;&gt;&quot;https://&amp;lt;HARBOR.DOMAIN.COM&amp;gt;/service/token&quot;&lt;/span&gt;,service=&lt;span class=&quot;string&quot;&gt;&quot;token-service&quot;&lt;/span&gt;,scope=&lt;span class=&quot;string&quot;&gt;&quot;registry:catalog:*&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## 会收到一条没有认证的消息，这个正常，返回一定是 401&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;errors&quot;&lt;/span&gt;:[&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;code&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;UNAUTHORIZED&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;message&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;authentication required&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;detail&quot;&lt;/span&gt;:[&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;Type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;registry&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;Name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;catalog&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;Action&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;*&quot;&lt;/span&gt;&amp;#125;]&amp;#125;]&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/service/token?account=&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&amp;amp;scope=repository:&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;/repo:push,pull&amp;amp;service=token-service&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Docker 安装及命令</title>
    <link href="http://blog.dongcj.com/m/Docker%E5%AE%89%E8%A3%85%E5%8F%8A%E5%91%BD%E4%BB%A4/"/>
    <id>http://blog.dongcj.com/m/Docker安装及命令/</id>
    <published>2018-02-07T08:34:01.732Z</published>
    <updated>2018-02-07T08:34:01.734Z</updated>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;为了支持 bbr、aufs，必须安装 extra, 详见：&lt;a href=&quot;http://blog.dongcj.com/linux/Linux%E5%8D%87%E7%BA%A7kernel%E5%8F%8Atcp_BBR/&quot;&gt;Linux 升级 kernel 及 tcp_BBR&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1-Ubuntu-安装-Docker&quot;&gt;&lt;a href=&quot;#1-Ubuntu-安装-Docker&quot; class=&quot;headerlink&quot; title=&quot;1. Ubuntu 安装 Docker&quot;&gt;&lt;/a&gt;1. Ubuntu 安装 Docker&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# clone 后直接脚本安装 , CentOS 没有测试过&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/rancher/install-docker.git&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ./install-docker&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install the latest docker release, eg: &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;bash 17.12.sh&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;2-配置-Docker-加速器（用于国内加速，可选）&quot;&gt;&lt;a href=&quot;#2-配置-Docker-加速器（用于国内加速，可选）&quot; class=&quot;headerlink&quot; title=&quot;2. 配置 Docker 加速器（用于国内加速，可选）&quot;&gt;&lt;/a&gt;2. 配置 Docker 加速器（用于国内加速，可选）&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;以下操作需重启 Docker 服务生效&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;vi /etc/docker/daemon.json&lt;/p&gt;
&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;registry-mirrors&quot;&lt;/span&gt;: [&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;     &lt;span class=&quot;string&quot;&gt;&quot;https://2lqq34jg.mirror.aliyuncs.com&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;     &lt;span class=&quot;string&quot;&gt;&quot;https://pee6w651.mirror.aliyuncs.com&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;     &lt;span class=&quot;string&quot;&gt;&quot;https://registry.docker-cn.com&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;     &lt;span class=&quot;string&quot;&gt;&quot;http://hub-mirror.c.163.com&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  ]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;3-配置-Docker-代理（国内无法访问国外某些网站的-https，可选）&quot;&gt;&lt;a href=&quot;#3-配置-Docker-代理（国内无法访问国外某些网站的-https，可选）&quot; class=&quot;headerlink&quot; title=&quot;3. 配置 Docker 代理（国内无法访问国外某些网站的 https，可选）&quot;&gt;&lt;/a&gt;3. 配置 Docker 代理（国内无法访问国外某些网站的 https，可选）&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;# 临时使用直接启动 dockerd（当然也可以写入 systemd 长期生效）&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;http_proxy=PROXY_ADDR:PORT https_proxy=PROXY_ADDR:PORT dockerd&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>SSH_config_proxycommand</title>
    <link href="http://blog.dongcj.com/m/SSH_config_proxycommand/"/>
    <id>http://blog.dongcj.com/m/SSH_config_proxycommand/</id>
    <published>2018-02-07T08:34:00.000Z</published>
    <updated>2018-02-07T09:57:59.182Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;proxycommand&quot;&gt;ProxyCommand&lt;/h1&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 直接跳到远程计算机&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ssh -o &lt;span class=&quot;string&quot;&gt;&quot;ProxyCommand ssh -p 1098 lmx@proxy.machine nc -w 1 %h %p&quot;&lt;/span&gt; -p 1098 lmx@target.machine&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 拷贝文件到远程计算机&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;scp -o &lt;span class=&quot;string&quot;&gt;&quot;ProxyCommand ssh -p 1098 lmx@proxy.machine nc -w 1 %h %p&quot;&lt;/span&gt; -P 1098 -r lmx@target.machine:~/rdsAgent .&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 在远程计算机执行命令&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ssh -o &lt;span class=&quot;string&quot;&gt;&quot;ProxyCommand ssh -p 1098 lmx@proxy.machine nc -w 1 %h %p&quot;&lt;/span&gt; -p 1098 lmx@target.machine &lt;span class=&quot;string&quot;&gt;&#39;ip a&#39;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;ssh-config-file-example&quot;&gt;ssh config file example&lt;/h1&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;$ cat ~/.ssh/config&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Host *&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ForwardAgent yes&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ForwardX11 no&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;KeepAlive yes&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ServerAliveInterval 30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;CheckHostIP no&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ControlMaster auto&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ControlPath /tmp/ssh_mux_%h_%p_%r&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# client --&amp;gt; 203.195.207.108:46707 --&amp;gt; 118.193.254.66:22&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Host hk-jumpserver&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;user root&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;IdentityFile /cygdrive/c/Users/root/id_rsa&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ProxyCommand ssh -i /cygdrive/c/Users/root/id_rsa root@203.195.207.108 -p 46707 nc 118.193.254.66 22&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Awk 命令</title>
    <link href="http://blog.dongcj.com/m/awk%E5%91%BD%E4%BB%A4/"/>
    <id>http://blog.dongcj.com/m/awk命令/</id>
    <published>2018-02-07T08:33:55.221Z</published>
    <updated>2018-02-07T09:35:57.282Z</updated>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;msg=$(awk &#39;      &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    BEGIN &amp;#123; IGNORECASE = 1; ORS = &quot;%20&quot; &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    /FAILED|ERROR/ &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        gsub(/[[:blank:]]+(FAILED|ERROR)/, &quot;&quot;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        gsub(/[[:blank:]]+/, &quot;_&quot;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gsub(/[^[:alnum:]_]/, &quot;&quot;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        print&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&#39; \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    /var/clone/check/check_baseos.log \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    /var/clone/check/check_gemstone_init.log \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    /var/clone/check/check_pe_profile.log \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    /var/clone/check/check_agent.log 2&amp;gt;/dev/null | cut -c1-70)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;``` &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 计算第三列的总和&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;```awk&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;awk &#39;&amp;#123; x += $3 &amp;#125; END &amp;#123; print x &amp;#125;&#39; myfile&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;1-awk-内建变量示例详解之-NR、FNR、NF、FILENAME&quot;&gt;&lt;a href=&quot;#1-awk-内建变量示例详解之-NR、FNR、NF、FILENAME&quot; class=&quot;headerlink&quot; title=&quot;1. awk 内建变量示例详解之 NR、FNR、NF、FILENAME&quot;&gt;&lt;/a&gt;1. awk 内建变量示例详解之 NR、FNR、NF、FILENAME&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;NR: Number of Record&lt;br&gt;NF: Number of Field&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight awk&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;cat class1.txt&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;zhaoyun &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;guanyu &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;liubei &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cat class2.txt&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;caocao &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;guojia &lt;span class=&quot;number&quot;&gt;99&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;awk &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;print FILENAME,&quot;NR=&quot;NR,&quot;FNR=&quot;FNR,&quot;$&quot;NF&quot;=&quot;$NF&amp;#125;&#39;&lt;/span&gt; class1.txt class2.txt&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;class1.txt NR=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; FNR=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$3&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;class1.txt NR=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; FNR=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$3&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;class1.txt NR=&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; FNR=&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$3&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;class2.txt NR=&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; FNR=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$4&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;class2.txt NR=&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; FNR=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$4&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Rancher 安装</title>
    <link href="http://blog.dongcj.com/docker/Rancher%E5%AE%89%E8%A3%85/"/>
    <id>http://blog.dongcj.com/docker/Rancher安装/</id>
    <published>2017-12-24T07:43:19.000Z</published>
    <updated>2017-12-24T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-准备步骤&quot;&gt;&lt;a href=&quot;#1-准备步骤&quot; class=&quot;headerlink&quot; title=&quot;1. 准备步骤&quot;&gt;&lt;/a&gt;1. 准备步骤&lt;/h1&gt;&lt;h2 id=&quot;1-1-服务器时间同步&quot;&gt;&lt;a href=&quot;#1-1-服务器时间同步&quot; class=&quot;headerlink&quot; title=&quot;1.1. 服务器时间同步&quot;&gt;&lt;/a&gt;1.1. 服务器时间同步&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;如果不配置时间同步，可能会导致调度服务有可能不正常 , 建议使用 &lt;strong&gt;UTC&lt;/strong&gt; 时间&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 直接删除 /etc/localtime 即可使用 UTC 时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;rm -rf /etc/localtime&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;1-2-支持-BBR，请升级内核至-4-9-以上版本（弱网环境建议）&quot;&gt;&lt;a href=&quot;#1-2-支持-BBR，请升级内核至-4-9-以上版本（弱网环境建议）&quot; class=&quot;headerlink&quot; title=&quot;1.2. 支持 BBR，请升级内核至 4.9 以上版本（弱网环境建议）&quot;&gt;&lt;/a&gt;1.2. 支持 BBR，请升级内核至 4.9 以上版本（弱网环境建议）&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;如果要支持 aufs，请安装 linux-image-extra 的包&lt;br&gt;参考链接： &lt;a href=&quot;http://blog.dongcj.com/linux/Linux%E5%8D%87%E7%BA%A7kernel%E5%8F%8Atcp_BBR/&quot;&gt;Linux 升级 Kernel 及 tcp_BBR&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;1-3-所有服务器设置外部-DNS&quot;&gt;&lt;a href=&quot;#1-3-所有服务器设置外部-DNS&quot; class=&quot;headerlink&quot; title=&quot;1.3. 所有服务器设置外部 DNS&quot;&gt;&lt;/a&gt;1.3. 所有服务器设置外部 DNS&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# stop and disable the local dns generator&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl stop systemd-resolved.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl &lt;span class=&quot;built_in&quot;&gt;disable&lt;/span&gt; systemd-resolved.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl stop resolvconf.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl &lt;span class=&quot;built_in&quot;&gt;disable&lt;/span&gt; resolvconf.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl stop NetworkManager.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl &lt;span class=&quot;built_in&quot;&gt;disable&lt;/span&gt; NetworkManager.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 修改为外部 DNS 服务器&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi /etc/network/interfaces&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  dns-nameservers 114.114.114.114&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# set the /etc/resolv.conf&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;unlink /etc/resolv.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi /etc/resolv.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nameserver 114.114.114.114&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# show the service status&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl status systemd-resolved.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl status resolvconf.service&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl status NetworkManager&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;systemctl restart docker&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# If has dnsmasq service&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Comment out the dns=dnsmasq line&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# vi /etc/NetworkManager/NetworkManager.conf&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# dns=dnsmasq&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# restart network and docker service&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#systemctl restart network-manager&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;1-4-设置-hostname&quot;&gt;&lt;a href=&quot;#1-4-设置-hostname&quot; class=&quot;headerlink&quot; title=&quot;1.4. 设置 hostname&quot;&gt;&lt;/a&gt;1.4. 设置 hostname&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;[root@rancher-server] echo &amp;quot;&amp;lt;HOSTNAME&amp;gt;&amp;quot; &amp;gt;/etc/hostname &amp;amp;&amp;amp; hostname &amp;lt;HOSTNAME&amp;gt;
[root@rancher-server] hostnamectl set-hostname svi1r01n08
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="docker" scheme="http://blog.dongcj.com/categories/docker/"/>
    
    
      <category term="rancher" scheme="http://blog.dongcj.com/tags/rancher/"/>
    
      <category term="docker" scheme="http://blog.dongcj.com/tags/docker/"/>
    
      <category term="caas" scheme="http://blog.dongcj.com/tags/caas/"/>
    
  </entry>
  
  <entry>
    <title>常用命令</title>
    <link href="http://blog.dongcj.com/linux/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://blog.dongcj.com/linux/常用命令/</id>
    <published>2017-12-04T00:50:10.000Z</published>
    <updated>2017-12-04T08:45:47.000Z</updated>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;[+]新增
[-]删除
[^]升级
[#]修复
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;1-高亮-tail-f-搜索&quot;&gt;&lt;a href=&quot;#1-高亮-tail-f-搜索&quot; class=&quot;headerlink&quot; title=&quot;1. 高亮 tail -f 搜索&quot;&gt;&lt;/a&gt;1. 高亮 tail -f 搜索&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;1. less xxx.log
2. 搜索你要高亮的关键字
3. SHIFT+F，进入 follow 模式
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;2-Windows&quot;&gt;&lt;a href=&quot;#2-Windows&quot; class=&quot;headerlink&quot; title=&quot;2. Windows&quot;&gt;&lt;/a&gt;2. Windows&lt;/h1&gt;&lt;h2 id=&quot;2-1-Windows-mount-网络共享为一个文件夹&quot;&gt;&lt;a href=&quot;#2-1-Windows-mount-网络共享为一个文件夹&quot; class=&quot;headerlink&quot; title=&quot;2.1. Windows mount 网络共享为一个文件夹&quot;&gt;&lt;/a&gt;2.1. Windows mount 网络共享为一个文件夹&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;net use \\192.168.11.111\public\data
mklink /d d:\ccc \\192.168.11.111\public\data
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;2-2-Windows-网络设置&quot;&gt;&lt;a href=&quot;#2-2-Windows-网络设置&quot; class=&quot;headerlink&quot; title=&quot;2.2. Windows 网络设置&quot;&gt;&lt;/a&gt;2.2. Windows 网络设置&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ipconfig | findstr /c:&amp;quot;IPv4&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sed -i -e &amp;quot;s/$/\x0d/g&amp;quot; $&amp;#123;MountPoint&amp;#125;/temp/postAfter.d/m01.configureNetworkInterfaces.bat&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;netsh interface ip show interfaces &amp;quot; 本地连接 &amp;quot;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;2-3-windows-如何删除隐藏设备&quot;&gt;&lt;a href=&quot;#2-3-windows-如何删除隐藏设备&quot; class=&quot;headerlink&quot; title=&quot;2.3. windows 如何删除隐藏设备&quot;&gt;&lt;/a&gt;2.3. windows 如何删除隐藏设备&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;set devmgr_show_nonpresent_devices=1
devmgmt.msc
打开隐藏设备
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="command" scheme="http://blog.dongcj.com/tags/command/"/>
    
  </entry>
  
  <entry>
    <title>Rfw-RemoteFirewall 远程管理防火墙</title>
    <link href="http://blog.dongcj.com/linux/security/Rfw-RemoteFirewall%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E9%98%B2%E7%81%AB%E5%A2%99/"/>
    <id>http://blog.dongcj.com/linux/security/Rfw-RemoteFirewall远程管理防火墙/</id>
    <published>2017-04-11T03:43:19.000Z</published>
    <updated>2017-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;&amp;gt; client: curl client (eg: 116.23.45.8)
&amp;gt; server: rfw servers (default port: 7393)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;install-rfw-on-ALL-server-on-client-amp-server&quot;&gt;&lt;a href=&quot;#install-rfw-on-ALL-server-on-client-amp-server&quot; class=&quot;headerlink&quot; title=&quot;install rfw on ALL server(on client &amp;amp; server)&quot;&gt;&lt;/a&gt;install rfw on ALL server(on client &amp;amp; server)&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;$ git clone https://github.com/securitykiss-com/rfw.git
$ cd rfw &amp;amp;&amp;amp; python setup.py install
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;generate-remote-crt-on-client&quot;&gt;&lt;a href=&quot;#generate-remote-crt-on-client&quot; class=&quot;headerlink&quot; title=&quot;generate remote crt(on client)&quot;&gt;&lt;/a&gt;generate remote crt(on client)&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;$ cd /etc/rfw/deploy/
$ rfwgen  11.11.11.11
$ rfwgen  22.22.22.22

# will generate the follow files
.
├── client
│   └── ca.crt
├── offline
│   └── ca.key
├── server_11.11.11.11
│   ├── server.crt
│   └── server.key
└── server_22.22.22.22
  ├── server.crt
  └── server.key
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;copy-key-to-server&quot;&gt;&lt;a href=&quot;#copy-key-to-server&quot; class=&quot;headerlink&quot; title=&quot;copy key to server&quot;&gt;&lt;/a&gt;copy key to server&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# on master server&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;scp /etc/rfw/deploy/server_11.11.11.11/server.key root@11.11.11.11:/etc/rfw/ssl/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;scp /etc/rfw/deploy/server_11.11.11.11/server.crt root@11.11.11.11:/etc/rfw/ssl/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;scp /etc/rfw/deploy/server_22.22.22.22/server.key root@22.22.22.22:/etc/rfw/ssl/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;scp /etc/rfw/deploy/server_22.22.22.22/server.crt root@22.22.22.22:/etc/rfw/ssl/&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;edit-the-server-config&quot;&gt;&lt;a href=&quot;#edit-the-server-config&quot; class=&quot;headerlink&quot; title=&quot;edit the server config&quot;&gt;&lt;/a&gt;edit the server config&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;$ vi /etc/rfw/rfw.conf
outward.server.certfile = /etc/rfw/ssl/server.crt
outward.server.keyfile = /etc/rfw/ssl/server.key
auth.username = your_username_here
auth.password = your_password_here

$ vi /etc/rfw/white.list
116.23.45.8
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
      <category term="security" scheme="http://blog.dongcj.com/categories/linux/security/"/>
    
    
      <category term="rfw" scheme="http://blog.dongcj.com/tags/rfw/"/>
    
      <category term="RemoteFirewall" scheme="http://blog.dongcj.com/tags/RemoteFirewall/"/>
    
  </entry>
  
  <entry>
    <title>Python2.6 升级至 python2.7</title>
    <link href="http://blog.dongcj.com/linux/Python2.6%E5%8D%87%E7%BA%A7%E8%87%B3python2.7/"/>
    <id>http://blog.dongcj.com/linux/Python2.6升级至python2.7/</id>
    <published>2016-11-28T09:44:33.000Z</published>
    <updated>2017-08-09T01:03:50.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;升级-python&quot;&gt;&lt;a href=&quot;#升级-python&quot; class=&quot;headerlink&quot; title=&quot;升级 python&quot;&gt;&lt;/a&gt;升级 python&lt;/h1&gt;&lt;h2 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;# 一定要先安装 zlib zlib-devel openssl openssl-devel，ncurses-devel，不然安装好后没有 zlib, 和 HTTPlib
$ yum -y install zlib-devel openssl-devel ncurses-devel libxml2-devel

$ yum -y install mysql mysql-devel

$ yum -y install libxml2-devel  libxslt-devel
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;编译安装-python-新版&quot;&gt;&lt;a href=&quot;#编译安装-python-新版&quot; class=&quot;headerlink&quot; title=&quot;编译安装 python 新版&quot;&gt;&lt;/a&gt;编译安装 python 新版&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;$ wget http://www.python.org/ftp/python/2.7.13/Python-2.7.13.tgz

# 加上 --enable-shared 解决 &amp;quot;Cannot build PL/Python because libpython is not a shared library&amp;quot;
$ tar -xzf Python-2.7.13.tgz &amp;amp;&amp;amp; cd Python-2.7.13 &amp;amp;&amp;amp; ./configure  --enable-shared
$ make all &amp;amp;&amp;amp; make install &amp;amp;&amp;amp; make clean &amp;amp;&amp;amp; make distclean

$ echo &amp;quot;/usr/local/lib&amp;quot; &amp;gt;&amp;gt;/etc/ld.so.conf
$ ldconfig
$ mv /usr/bin/python /usr/bin/python2.6.bak
$ ln -s /usr/local/bin/python /usr/bin/python

# copy bz2 module
$ yes | cp -rLfap /usr/lib64/python2.*/lib-dynload/bz2.so /usr/local/lib/python2.*/
$ python -V
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;安装-easy-install-和-pip&quot;&gt;&lt;a href=&quot;#安装-easy-install-和-pip&quot; class=&quot;headerlink&quot; title=&quot;安装 easy_install 和 pip&quot;&gt;&lt;/a&gt;安装 easy_install 和 pip&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# 参见：[《linux 安装 easy_install 及 pip》][1]
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;修改-yum-中的-python-版本为-python2-6&quot;&gt;&lt;a href=&quot;#修改-yum-中的-python-版本为-python2-6&quot; class=&quot;headerlink&quot; title=&quot;修改 yum 中的 python 版本为 python2.6&quot;&gt;&lt;/a&gt;修改 yum 中的 python 版本为 &lt;strong&gt;python2.6&lt;/strong&gt;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;$ vi /usr/bin/yum
$ vi /usr/bin/yum-config-manager
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;安装一些基础软件&quot;&gt;&lt;a href=&quot;#安装一些基础软件&quot; class=&quot;headerlink&quot; title=&quot;安装一些基础软件&quot;&gt;&lt;/a&gt;安装一些基础软件&lt;/h2&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="python 升级" scheme="http://blog.dongcj.com/tags/python-%E5%8D%87%E7%BA%A7/"/>
    
  </entry>
  
  <entry>
    <title>SMATE、XFCE、VNC 配置</title>
    <link href="http://blog.dongcj.com/linux/SMATE%E3%80%81XFCE%E3%80%81VNC%E9%85%8D%E7%BD%AE/"/>
    <id>http://blog.dongcj.com/linux/SMATE、XFCE、VNC配置/</id>
    <published>2016-08-30T09:27:43.000Z</published>
    <updated>2016-08-30T09:48:08.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;YUM-安装图像界面及-VNC&quot;&gt;&lt;a href=&quot;#YUM-安装图像界面及-VNC&quot; class=&quot;headerlink&quot; title=&quot;YUM 安装图像界面及 VNC&quot;&gt;&lt;/a&gt;YUM 安装图像界面及 VNC&lt;/h1&gt;&lt;p&gt;( 参考：&lt;a href=&quot;http://www.ha97.com/4634.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.ha97.com/4634.html&lt;/a&gt; )&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum install epel-release

yum grouplist
yum groupinstall &amp;quot;GNOME Desktop Environment&amp;quot;（CentOS 5.x 安装 GNOME 桌面环境）
yum groupinstall &amp;quot;X Window System&amp;quot; &amp;quot;Desktop&amp;quot;（CentOS 6.x 安装 GNOME 桌面环境）

yum groupinstall [ xfce | &amp;quot;MATE Desktop&amp;quot; ]（CentOS 安装 xfce 桌面环境，可选）

# runlevel 5
systemctl isolate graphical.target

# Start the GUI on boot
systemctl set-default graphical.target

# 切换 display manager
# 查看
ls -l /etc/systemd/system/display-manager.service

# 切换
systemctl disable gdm &amp;amp;&amp;amp; systemctl enable lightdm

# 刷新
systemctl isolate graphical.target
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;安装-vnc-server&quot;&gt;&lt;a href=&quot;#安装-vnc-server&quot; class=&quot;headerlink&quot; title=&quot;安装 vnc server&quot;&gt;&lt;/a&gt;安装 vnc server&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# 安装 Xfce 要使用 vncserver，需修改 /root/.vnc/xstartup 里为 exec /bin/sh /etc/xdg/xfce4/xinitrc 即可
yum install vnc-server vnc* （CentOS 5.x 里）
yum install tigervnc-server tigervnc （CentOS 6.x 里）
/etc/init.d/vncserver restart

# 关闭具体的 vncserver 命令 :
vncserver -kill :1
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://jensd.be/125/linux/rhel/install-mate-or-xfce-on-centos-7&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://jensd.be/125/linux/rhel/install-mate-or-xfce-on-centos-7&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="xorg" scheme="http://blog.dongcj.com/tags/xorg/"/>
    
      <category term="smate" scheme="http://blog.dongcj.com/tags/smate/"/>
    
      <category term="xfce" scheme="http://blog.dongcj.com/tags/xfce/"/>
    
      <category term="vnc" scheme="http://blog.dongcj.com/tags/vnc/"/>
    
  </entry>
  
  <entry>
    <title>使用 Printf 进行格式化</title>
    <link href="http://blog.dongcj.com/linux/%E4%BD%BF%E7%94%A8printf%E8%BF%9B%E8%A1%8C%E6%A0%BC%E5%BC%8F%E5%8C%96/"/>
    <id>http://blog.dongcj.com/linux/使用printf进行格式化/</id>
    <published>2016-08-30T09:27:43.000Z</published>
    <updated>2016-08-30T09:48:08.000Z</updated>
    
    <summary type="html">
    
      &lt;h2 id=&quot;表格输出&quot;&gt;&lt;a href=&quot;#表格输出&quot; class=&quot;headerlink&quot; title=&quot;表格输出&quot;&gt;&lt;/a&gt;表格输出&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#/bin/bash&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;divider===============================&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;divider=&lt;span class=&quot;variable&quot;&gt;$divider&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$divider&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;header=&lt;span class=&quot;string&quot;&gt;&quot;\n %-10s %8s %10s %11s\n&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;format=&lt;span class=&quot;string&quot;&gt;&quot; %-10s %08d %10s %11.2f\n&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;width=43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$header&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;ITEM NAME&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;ITEM ID&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;COLOR&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;PRICE&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%&lt;span class=&quot;variable&quot;&gt;$width&lt;/span&gt;.&lt;span class=&quot;variable&quot;&gt;$&amp;#123;width&amp;#125;&lt;/span&gt;s\n&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$divider&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$format&lt;/span&gt;&quot;&lt;/span&gt; \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Triangle 13  red 20 \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Oval 204449 &lt;span class=&quot;string&quot;&gt;&quot;dark blue&quot;&lt;/span&gt; 65.656 \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Square 3145 orange .7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%s\n&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;\n3&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;\n3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%b\n&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;\n3&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%d\n&quot;&lt;/span&gt; 255 0xff 0377 3.5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;bash: &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;: 3.5: invalid number&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%f\n&quot;&lt;/span&gt; 255 0xff 0377 3.5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255.000000&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255.000000&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;377.000000&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3.500000&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%.1f\n&quot;&lt;/span&gt; 255 0xff 0377 3.5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255.0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;255.0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;377.0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3.5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; $( seq 1 10 ); &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;%03d\t&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;&quot;&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;001     002     003     004     005     006     007     008     009     010&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="shell" scheme="http://blog.dongcj.com/tags/shell/"/>
    
      <category term="printf" scheme="http://blog.dongcj.com/tags/printf/"/>
    
  </entry>
  
  <entry>
    <title>Linux 升级 Kernel 及 tcp_BBR</title>
    <link href="http://blog.dongcj.com/linux/Linux%E5%8D%87%E7%BA%A7kernel%E5%8F%8Atcp_BBR/"/>
    <id>http://blog.dongcj.com/linux/Linux升级kernel及tcp_BBR/</id>
    <published>2016-08-28T09:44:33.000Z</published>
    <updated>2016-06-07T06:25:00.000Z</updated>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 这二个是打开 BBR 必需的&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 先查看内核是否大于 4.9，如大于 4.9，直接使用以下命令即可&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果不是，则需先按下方升级内核&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;net.core.default_qdisc=fq&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/sysctl.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;net.ipv4.tcp_congestion_control=bbr&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/sysctl.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 保存生效&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sysctl -p&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看 bbr 是否生效&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;lsmod | grep bbr&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;1-Debian、Ubuntu-升级内核&quot;&gt;&lt;a href=&quot;#1-Debian、Ubuntu-升级内核&quot; class=&quot;headerlink&quot; title=&quot;1. Debian、Ubuntu 升级内核&quot;&gt;&lt;/a&gt;1. Debian、Ubuntu 升级内核&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 直接使用 apt-get 安装内核&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;apt-get update&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;apt-cache search linux-image-extra&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 安装最新的内核&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;apt-get install linux-image-extra-&amp;lt;NEWEST_KERNEL_RELEASE&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;dpkg -l | grep linux-image&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;apt-get remove &amp;lt;OLD_KERNEL_RELEASE&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;update-grub&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;reboot&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看一下目前的内核版本&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 应该是显示为 &amp;lt;NEWEST_KERNEL_RELEASE&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;uname -r&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;2-RHEL、CentOS-升级内核&quot;&gt;&lt;a href=&quot;#2-RHEL、CentOS-升级内核&quot; class=&quot;headerlink&quot; title=&quot;2. RHEL、CentOS 升级内核&quot;&gt;&lt;/a&gt;2. RHEL、CentOS 升级内核&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;yum update -y&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果是 el7&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果是 el6&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;rpm -Uvh http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 安装内核&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;yum --enablerepo=elrepo-kernel install kernel-ml&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看当前已安装的内核&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;awk -F\&lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt;==&lt;span class=&quot;string&quot;&gt;&quot;menuentry &quot;&lt;/span&gt; &amp;#123;&lt;span class=&quot;built_in&quot;&gt;print&lt;/span&gt; i++ &lt;span class=&quot;string&quot;&gt;&quot; : &quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt;&amp;#125;&lt;span class=&quot;string&quot;&gt;&#39; /etc/grub2.cfg&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 设定默认内核 (centos7)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;grub2-set-default 0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;reboot&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 设定默认内核 (centos6)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi /etc/grub.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 修改 default=&amp;lt;ID 号 &amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 设定 /etc/sysctl.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;net.core.default_qdisc = fq&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;net.ipv4.tcp_congestion_control = bbr&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 生效&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sysctl -p&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;3-手动安装&quot;&gt;&lt;a href=&quot;#3-手动安装&quot; class=&quot;headerlink&quot; title=&quot;3. 手动安装&quot;&gt;&lt;/a&gt;3. 手动安装&lt;/h1&gt;&lt;h2 id=&quot;3-1-下载内核二进制包&quot;&gt;&lt;a href=&quot;#3-1-下载内核二进制包&quot; class=&quot;headerlink&quot; title=&quot;3.1. 下载内核二进制包&quot;&gt;&lt;/a&gt;3.1. 下载内核二进制包&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;链接：&lt;a href=&quot;http://mirrors.kernel.org/debian/pool/main/l/linux/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://mirrors.kernel.org/debian/pool/main/l/linux/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;3-2-解压安装&quot;&gt;&lt;a href=&quot;#3-2-解压安装&quot; class=&quot;headerlink&quot; title=&quot;3.2. 解压安装&quot;&gt;&lt;/a&gt;3.2. 解压安装&lt;/h2&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="升级内核" scheme="http://blog.dongcj.com/tags/%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/"/>
    
      <category term="kernel" scheme="http://blog.dongcj.com/tags/kernel/"/>
    
      <category term="bbr" scheme="http://blog.dongcj.com/tags/bbr/"/>
    
      <category term="tcp_bbr" scheme="http://blog.dongcj.com/tags/tcp-bbr/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 部署 Lazy-Balancer 负载均衡　</title>
    <link href="http://blog.dongcj.com/linux/CentOS%E9%83%A8%E7%BD%B2lazy-balancer%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    <id>http://blog.dongcj.com/linux/CentOS部署lazy-balancer负载均衡/</id>
    <published>2016-08-28T09:44:33.000Z</published>
    <updated>2018-02-07T08:33:57.438Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;clone-soft&quot;&gt;&lt;a href=&quot;#clone-soft&quot; class=&quot;headerlink&quot; title=&quot;clone soft&quot;&gt;&lt;/a&gt;clone soft&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ git clone https://github.com/v55448330/lazy-balancer.git /usr/local/lazy_balancer
$ cd /usr/local/lazy_balancer
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;install-tengine&quot;&gt;&lt;a href=&quot;#install-tengine&quot; class=&quot;headerlink&quot; title=&quot;install tengine&quot;&gt;&lt;/a&gt;install tengine&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ git submodule update --init --recursive

$ cd resource/nginx/tengine
$ yum -y install pcre-devel

$ ./configure --user=nginx --group=nginx --prefix=/etc/nginx --sbin-path=/usr/sbin --error-log-path=/var/log/nginx/error.log --conf-path=/etc/nginx/nginx.conf --pid-path=/var/run/nginx.pid
$ make &amp;amp;&amp;amp; make install

# add nginx user
$ adduser --system --no-create-home --shell /bin/false   nginx
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;install-supervisor&quot;&gt;&lt;a href=&quot;#install-supervisor&quot; class=&quot;headerlink&quot; title=&quot;install supervisor&quot;&gt;&lt;/a&gt;install supervisor&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ yum -y install supervisor

# add to supervisor config file
$ echo &amp;quot;[include]&amp;quot; &amp;gt;&amp;gt;/etc/supervisord.conf
$ echo &amp;quot;files = /etc/supervisor/conf.d/*.conf&amp;quot; &amp;gt;&amp;gt;/etc/supervisord.conf

$ cp -rf /usr/local/lazy_balancer/service/* /etc/supervisor/
$ vi /etc/supervisor/conf.d/supervisor_balancer.conf
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;start-service&quot;&gt;&lt;a href=&quot;#start-service&quot; class=&quot;headerlink&quot; title=&quot;start service&quot;&gt;&lt;/a&gt;start service&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ service supervisor restart
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="nginx" scheme="http://blog.dongcj.com/tags/nginx/"/>
    
      <category term="tengine" scheme="http://blog.dongcj.com/tags/tengine/"/>
    
      <category term="lazy-balancer" scheme="http://blog.dongcj.com/tags/lazy-balancer/"/>
    
  </entry>
  
  <entry>
    <title>Mdadm_raid10_raid5</title>
    <link href="http://blog.dongcj.com/linux/Mdadm_raid10_raid5/"/>
    <id>http://blog.dongcj.com/linux/Mdadm_raid10_raid5/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h3 id=&quot;每块硬盘分一个区&quot;&gt;&lt;a href=&quot;#每块硬盘分一个区&quot; class=&quot;headerlink&quot; title=&quot;每块硬盘分一个区&quot;&gt;&lt;/a&gt;每块硬盘分一个区&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;# 分区格式为 Linux software raid：

$ fdisk /dev/sda

  WARNING: DOS-compatible mode is deprecated. It&amp;apos;s strongly recommended to
           switch off the mode (command &amp;apos;c&amp;apos;) and change display units to
           sectors (command &amp;apos;u&amp;apos;).

  Command (m for help): n
  Command action
     e   extended
     p   primary partition (1-4)
  p
  Partition number (1-4): 1
  First cylinder (1-91201, default 1):
  Using default value 1
  Last cylinder, +cylinders or +size{K,M,G} (1-91201, default 91201):
  Using default value 91201

  Command (m for help): p

  Disk /dev/sda: 750.2 GB, 750156374016 bytes
  255 heads, 63 sectors/track, 91201 cylinders
  Units = cylinders of 16065 * 512 = 8225280 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disk identifier: 0x0005c259

     Device Boot      Start         End      Blocks   Id  System
  /dev/sda1               1       91201   732572001   83  Linux

  Command (m for help): t
  Selected partition 1
  Hex code (type L to list codes): fd
  Changed system type of partition 1 to fd (Linux raid autodetect)

  Command (m for help): w
  The partition table has been altered!

  Calling ioctl() to re-read partition table.
  Syncing disks.
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;更改分区格式&quot;&gt;&lt;a href=&quot;#更改分区格式&quot; class=&quot;headerlink&quot; title=&quot;更改分区格式&quot;&gt;&lt;/a&gt;更改分区格式&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# 按照上面的 /dev/sda 的分区例子依次给剩下的 5 块硬盘 sdc, sdd, sde, sdf, sdg 分区
$ fdisk /dev/sdc
...
$ fdisk /dev/sdd
...
$ fdisk /dev/sde
...
$ fdisk /dev/sdf
...
$ fdisk /dev/sdg
...
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;创建-RAID&quot;&gt;&lt;a href=&quot;#创建-RAID&quot; class=&quot;headerlink&quot; title=&quot;创建 RAID&quot;&gt;&lt;/a&gt;创建 RAID&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# 在上面的 6 个相同大小的分区上创建 raid10
$ mdadm --create /dev/md0 -v --raid-devices=6 --level=raid10 /dev/sda1 /dev/sdc1 /dev/sdd1 /dev/sde1 /dev/sdf1 /dev/sdg1
mdadm: layout defaults to n2
mdadm: layout defaults to n2
mdadm: chunk size defaults to 512K
mdadm: size set to 732440576K
mdadm: Defaulting to version 1.2 metadata
mdadm: array /dev/md0 started.

# 查看磁盘阵列的初始化过程（build），根据磁盘大小和速度，整个过程大概需要几个小时：
# watch cat /proc/mdstat
Every 2.0s: cat /proc/mdstat                                       Tue Feb 11 12:51:25 2014

Personalities : [raid10]
md0 : active raid10 sdg1[5] sdf1[4] sde1[3] sdd1[2] sdc1[1] sda1[0]
      2197321728 blocks super 1.2 512K chunks 2 near-copies [6/6] [UUUUUU]
      [&amp;gt;....................]  resync =  0.2% (5826816/2197321728) finish=278.9min speed=13
0948K/sec

unused devices:

$ fdisk /dev/md0
$ mkfs.ext4 /dev/md0p1

$ mkdir /raid10
$ mount /dev/md0p1 /raid10

$ vi /etc/fstab
  ...
  /dev/md0p1 /raid10 ext4 noatime,rw 0 0

$ blkid
  ...
  /dev/md0p1: UUID=&amp;quot;093e0605-1fa2-4279-99b2-746c70b78f1b&amp;quot; TYPE=&amp;quot;ext4&amp;quot;

$ vi /etc/fstab
  ...
  /dev/md0p1 /raid10 ext4 noatime,rw 0 0
  **UUID=093e0605-1fa2-4279-99b2-746c70b78f1b /raid10 ext4 noatime,rw 0 0**

$ mdadm --query --detail /dev/md0
/dev/md0:
        Version : 1.2
  Creation Time : Tue Feb 11 12:50:38 2014
     Raid Level : raid10
     Array Size : 2197321728 (2095.53 GiB 2250.06 GB)
  Used Dev Size : 732440576 (698.51 GiB 750.02 GB)
   Raid Devices : 6
  Total Devices : 6
    Persistence : Superblock is persistent

    Update Time : Tue Feb 11 18:48:10 2014
          State : clean
 Active Devices : 6
Working Devices : 6
 Failed Devices : 0
  Spare Devices : 0

         Layout : near=2
     Chunk Size : 512K

           Name : local:0  (local to host local)
           UUID : e3044b6c:5ab972ea:8e742b70:3f766a11
         Events : 70

    Number   Major   Minor   RaidDevice State
       0       8        1        0      active sync   /dev/sda1
       1       8       33        1      active sync   /dev/sdc1
       2       8       49        2      active sync   /dev/sdd1
       3       8       65        3      active sync   /dev/sde1
       4       8       81        4      active sync   /dev/sdf1
       5       8       97        5      active sync   /dev/sdg1

$ echo device /dev/sdb1 /dev/sdc1 /dev/sdd1 &amp;gt; /etc/mdadm.conf
$ mdadm --detail --scan &amp;gt;&amp;gt; /etc/mdadm.conf
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;RAID-维护命令&quot;&gt;&lt;a href=&quot;#RAID-维护命令&quot; class=&quot;headerlink&quot; title=&quot;RAID 维护命令&quot;&gt;&lt;/a&gt;RAID 维护命令&lt;/h1&gt;&lt;h2 id=&quot;删除故障盘&quot;&gt;&lt;a href=&quot;#删除故障盘&quot; class=&quot;headerlink&quot; title=&quot;删除故障盘&quot;&gt;&lt;/a&gt;删除故障盘&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;$ mdadm /dev/md0 -r /dev/sdb1
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;增加新盘&quot;&gt;&lt;a href=&quot;#增加新盘&quot; class=&quot;headerlink&quot; title=&quot;增加新盘&quot;&gt;&lt;/a&gt;增加新盘&lt;/h2&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="soft raid" scheme="http://blog.dongcj.com/tags/soft-raid/"/>
    
      <category term="mdadm" scheme="http://blog.dongcj.com/tags/mdadm/"/>
    
  </entry>
  
  <entry>
    <title>Nginx 及 Upstreamcheck,fair 模块安装</title>
    <link href="http://blog.dongcj.com/web/Nginx%E5%8F%8Aupstreamcheck,fair%E6%A8%A1%E5%9D%97%E5%AE%89%E8%A3%85/"/>
    <id>http://blog.dongcj.com/web/Nginx及upstreamcheck,fair模块安装/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;download-nginx-module&quot;&gt;download nginx &amp;amp; module&lt;/h1&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /tmp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# main software&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;wget http://nginx.org/download/nginx-1.11.5.tar.gz&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dependency(if necessary)&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;wget https://nchc.dl.sourceforge.net/project/pcre/pcre/8.41/pcre-8.41.tar.gz&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# module nginx_upstream_check_module&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/yaoweibin/nginx_upstream_check_module.git&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# module nginx-upstream-fair&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/gnosek/nginx-upstream-fair.git&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;make-install&quot;&gt;make &amp;amp; install&lt;/h1&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install dependency(if necessary)&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tar xzf pcre-8.41.tar.gz&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; pcre-8.41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;./configure&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;make &amp;amp;&amp;amp; make install&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ldconfig&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# install nginx&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tar xzf nginx-1.11.5.tar.gz&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; nginx-1.11.5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;./configure --user=nobody --group=nobody --prefix=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/nginx/ \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;--with-http_stub_status_module \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;--add-module=../nginx_upstream_check_module \&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;--add-module=../nginx-upstream-fair&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;make &amp;amp;&amp;amp; make install&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;nginx.conf-proxy.conf&quot;&gt;nginx.conf &amp;amp; proxy.conf&lt;/h1&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;75&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;76&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;77&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;78&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;80&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;81&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;82&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;83&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;84&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;85&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;86&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;87&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;88&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;89&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;90&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;91&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;92&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;93&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;94&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;95&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;96&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;97&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;98&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;99&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;100&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;101&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;102&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;103&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;104&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;105&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;vi /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/nginx/conf/nginx.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;user  nobody;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;worker_processes  4;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# security&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# server_tokens   off;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# proxy_hide_header   X-Powered-By;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;error_log     /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/nginx/error.log  warn;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#error_log     /var/log/nginx/error.log  notice;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#error_log      /var/log/nginx/error.log  debug;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pid        /var/run/nginx.pid;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;events &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    worker_connections  8192;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;http &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    include       /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/nginx/conf/mime.types;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    default_type  application/octet-stream;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    log_format  main  &lt;span class=&quot;string&quot;&gt;&#39;$remote_addr - $remote_user [$time_local]&quot;$request&quot;&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                      &lt;span class=&quot;string&quot;&gt;&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                      &lt;span class=&quot;string&quot;&gt;&#39;&quot;$http_user_agent&quot;&quot;$http_x_forwarded_for&quot;&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    access_log  /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/nginx/access.log  main;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    sendfile        on;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tcp_nopush      on;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    tcp_nodelay     on;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    keepalive_timeout  65;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 设定负载均衡的服务器列表 &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    upstream lb.xxx.com &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        server xxxx:8088;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        server xxxx:8088;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# upstream check&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        check interval=6000 rise=1 fall=3 timeout=4000;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# fairly scheduler&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        fair;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# fastcgi config&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_connect_timeout 300;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_send_timeout 300;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_read_timeout 300;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_buffer_size 64k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_buffers 4 64k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_busy_buffers_size 128k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    fastcgi_temp_file_write_size 128k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# gzip config&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip on;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip_min_length  1k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip_buffers     4 16k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip_http_version 1.0;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip_comp_level 2;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip_types       text/plain application/x-javascript text/css application/xml;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gzip_vary on;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    server &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        listen 80;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        include proxy.conf;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# check_status_module&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# usage: curl http://localhost/status?format=json&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# 好像无法生效 &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        location /status?format=json &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            check_status;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            access_log  off;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            allow 127.0.0.1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            deny all;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# http_stub_status&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        location /ng_status &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            stub_status on;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            access_log  off;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            allow 127.0.0.1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            deny all;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# upstream&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        location / &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            proxy_pass http://lb.xxx.com;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# static file expires&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            location ~ .*\.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)($|/) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            expires      30d;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# js &amp;amp; css expires&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            location ~ .*\.(js|css)($|/) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            expires      8h;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;vi&lt;/span&gt; /usr/local/nginx/conf/proxy.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;proxy_redirect &lt;span class=&quot;literal&quot;&gt;off&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_set_header&lt;/span&gt; Host &lt;span class=&quot;variable&quot;&gt;$host&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_set_header&lt;/span&gt; X-Real-IP &lt;span class=&quot;variable&quot;&gt;$remote_addr&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_set_header&lt;/span&gt; X-Forwarded-For &lt;span class=&quot;variable&quot;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;client_max_body_size&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10m&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;client_body_buffer_size&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;128k&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_connect_timeout&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_send_timeout&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_read_timeout&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_buffer_size&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;4k&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_buffers&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;32k&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_busy_buffers_size&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;64k&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;proxy_temp_file_write_size&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;64k&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;start-auto-start&quot;&gt;start &amp;amp; auto-start&lt;/h2&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# autostart&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf&quot;&lt;/span&gt; &amp;gt;&amp;gt;/etc/rc.local&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make log dir&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mkdir -p /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/nginx/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# start&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/etc/rc.local&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# stop&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pkill nginx&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# reload&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nginx -s reload&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
      <category term="web" scheme="http://blog.dongcj.com/categories/web/"/>
    
    
      <category term="nginx" scheme="http://blog.dongcj.com/tags/nginx/"/>
    
      <category term="upstreamcheck" scheme="http://blog.dongcj.com/tags/upstreamcheck/"/>
    
  </entry>
  
  <entry>
    <title>编码与文件格式转换</title>
    <link href="http://blog.dongcj.com/linux/%E7%BC%96%E7%A0%81%E4%B8%8E%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2/"/>
    <id>http://blog.dongcj.com/linux/编码与文件格式转换/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;作用&quot;&gt;&lt;a href=&quot;#作用&quot; class=&quot;headerlink&quot; title=&quot;作用&quot;&gt;&lt;/a&gt;作用&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;在 windows 下使用 hexo 时，经常会出现 GBK 编码与 DOS 的问题&lt;br&gt;Windows 下自动将博客发布到 github&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;编码转换-“Trans-To-UTF-8-py”&quot;&gt;&lt;a href=&quot;#编码转换-“Trans-To-UTF-8-py”&quot; class=&quot;headerlink&quot; title=&quot;编码转换 “Trans_To_UTF-8.py”&quot;&gt;&lt;/a&gt;编码转换 “Trans_To_UTF-8.py”&lt;/h1&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 请把以下脚本放至 /usr/local/bin/ 目录下&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; os,sys&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;( filename, in_enc = &lt;span class=&quot;string&quot;&gt;&quot;GBK&quot;&lt;/span&gt;, out_enc=&lt;span class=&quot;string&quot;&gt;&quot;UTF8&quot;&lt;/span&gt; )&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;convert &quot;&lt;/span&gt; + filename,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        content = open(filename).read()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        new_content = content.decode(in_enc).encode(out_enc)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        open(filename, &lt;span class=&quot;string&quot;&gt;&#39;w&#39;&lt;/span&gt;).write(new_content)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot; done&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt;:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot; error&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;explore&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(dir)&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; root, dirs, files &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; os.walk(dir):&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; file &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; files:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            path = os.path.join(root, file)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            convert(path)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; path &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; sys.argv[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:]:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; os.path.isfile(path):&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            convert(path)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;elif&lt;/span&gt; os.path.isdir(path):&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            explore(path)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;string&quot;&gt;&quot;__main__&quot;&lt;/span&gt;:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    main()&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;准备脚本-“prepare-sh”&quot;&gt;&lt;a href=&quot;#准备脚本-“prepare-sh”&quot; class=&quot;headerlink&quot; title=&quot;准备脚本 “prepare.sh”&quot;&gt;&lt;/a&gt;准备脚本 “prepare.sh”&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;POST_DIR=&lt;span class=&quot;string&quot;&gt;&quot;/cygdrive/e/blog/source/_posts&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;FBS_ESC=`&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -en &lt;span class=&quot;string&quot;&gt;&quot;\033&quot;&lt;/span&gt;`&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COLOR_RED=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;FBS_ESC&amp;#125;&lt;/span&gt;[1;31m&quot;&lt;/span&gt;       &lt;span class=&quot;comment&quot;&gt;# Error&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COLOR_GREEN=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;FBS_ESC&amp;#125;&lt;/span&gt;[1;32m&quot;&lt;/span&gt;;    &lt;span class=&quot;comment&quot;&gt;# Success&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COLOR_YELLOW=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;FBS_ESC&amp;#125;&lt;/span&gt;[1;33m&quot;&lt;/span&gt;    &lt;span class=&quot;comment&quot;&gt;# Warning&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;COLOR_CLOSE=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;FBS_ESC&amp;#125;&lt;/span&gt;[0m&quot;&lt;/span&gt;        &lt;span class=&quot;comment&quot;&gt;# Close&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$POST_DIR&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; *; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; grep -q &lt;span class=&quot;string&quot;&gt;&quot;author: dongcj &amp;lt;ntwk@163.com&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_GREEN&amp;#125;&lt;/span&gt;SKIP&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;: filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;...&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;continue&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; file &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; | grep -q &lt;span class=&quot;string&quot;&gt;&quot;CRLF&quot;&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# change to unix&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -n &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_YELLOW&amp;#125;&lt;/span&gt;WARN&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;: filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, coverting to unix..&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        dos2unix &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt; || &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_RED&amp;#125;&lt;/span&gt;failed&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! file &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; | grep -q &lt;span class=&quot;string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# change to UTF-8&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        python /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/Trans_To_UTF-8.py &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt; || &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_RED&amp;#125;&lt;/span&gt;failed&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! ls &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; | grep -q &lt;span class=&quot;string&quot;&gt;&quot;\.md$&quot;&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -n &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_YELLOW&amp;#125;&lt;/span&gt;WARN&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;: filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, renaming to &lt;span class=&quot;variable&quot;&gt;$&amp;#123;i%.*&amp;#125;&lt;/span&gt;.md..&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# rename suffix to &quot;.md&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        mv &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$&amp;#123;i%.*&amp;#125;&lt;/span&gt;.md &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt; || &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_RED&amp;#125;&lt;/span&gt;failed&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, skipped rename~&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    no_suffix_filename=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;i%.*&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# if does not have title&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! grep -q &lt;span class=&quot;string&quot;&gt;&quot;title:&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -n &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_YELLOW&amp;#125;&lt;/span&gt;WARN&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;: filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, adding title..&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        sed -i &lt;span class=&quot;string&quot;&gt;&quot;1s/^/---\ntitle: &lt;span class=&quot;variable&quot;&gt;$no_suffix_filename&lt;/span&gt;\n---\n/&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# zero title content&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    title_content=`sed -n &lt;span class=&quot;string&quot;&gt;&#39;/title: /p&#39;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; | awk -F&lt;span class=&quot;string&quot;&gt;&#39;:&#39;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;print $NF&amp;#125;&#39;&lt;/span&gt; | xargs`&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ -z &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$title_content&lt;/span&gt;&quot;&lt;/span&gt; ]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# update title when it is NULL&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -n &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_YELLOW&amp;#125;&lt;/span&gt;WARN&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;: filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, updating title..&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        sed -i &lt;span class=&quot;string&quot;&gt;&quot;s/title: .*/title: &lt;span class=&quot;variable&quot;&gt;$no_suffix_filename&lt;/span&gt;/&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, skipped update~&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# add author info&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! grep -q &lt;span class=&quot;string&quot;&gt;&quot;author: dongcj &amp;lt;ntwk@163.com&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; -n &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_YELLOW&amp;#125;&lt;/span&gt;WARN&lt;span class=&quot;variable&quot;&gt;$&amp;#123;COLOR_CLOSE&amp;#125;&lt;/span&gt;: filename: &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;, updating author..&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        sed -i &lt;span class=&quot;string&quot;&gt;&#39;/title: /a author: dongcj &amp;lt;ntwk@163.com&amp;gt;&#39;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;Windows-下-“-更新博客-bat”&quot;&gt;&lt;a href=&quot;#Windows-下-“-更新博客-bat”&quot; class=&quot;headerlink&quot; title=&quot;Windows 下 “ 更新博客 .bat”&quot;&gt;&lt;/a&gt;Windows 下 “ 更新博客 .bat”&lt;/h1&gt;&lt;figure class=&quot;highlight bat&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;REM&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; &quot;/cygdriver/d/blog&quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;D:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;hexo&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;g&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;title&quot;&gt;hexo&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;d&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;echo&lt;/span&gt; &quot;&lt;span class=&quot;title&quot;&gt;success&lt;/span&gt;&quot;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="utf-8" scheme="http://blog.dongcj.com/tags/utf-8/"/>
    
      <category term="编码" scheme="http://blog.dongcj.com/tags/%E7%BC%96%E7%A0%81/"/>
    
      <category term="hexo" scheme="http://blog.dongcj.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Gearman 安装</title>
    <link href="http://blog.dongcj.com/cluster/Gearman%E5%AE%89%E8%A3%85/"/>
    <id>http://blog.dongcj.com/cluster/Gearman安装/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;参考&lt;br&gt;    &lt;a href=&quot;http://www.php-oa.com/2010/09/05/perl-gearman-distributed.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.php-oa.com/2010/09/05/perl-gearman-distributed.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;python gearman library home page
http://samuelks.com/python-gearman/docs/

Tim Yang：利用 Gearman 来实现远程监控与管理
http://timyang.net/linux/gearman-monitor/
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;一、安装-grarmand-及-libgearman-devel&quot;&gt;&lt;a href=&quot;#一、安装-grarmand-及-libgearman-devel&quot; class=&quot;headerlink&quot; title=&quot;一、安装 grarmand 及 libgearman-devel&quot;&gt;&lt;/a&gt;一、安装 grarmand 及 libgearman-devel&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ yum install gearmand libgearman-devel  php-pecl-gearman  ( 直接安装这个 php-pecl-gearman 就不用第二步：安装 PHP 的 API 了 )
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;二、安装-PHP-的-API&quot;&gt;&lt;a href=&quot;#二、安装-PHP-的-API&quot; class=&quot;headerlink&quot; title=&quot;二、安装 PHP 的 API&quot;&gt;&lt;/a&gt;二、安装 PHP 的 API&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ yum install php php-devel boost boost-devel libuuid libuuid-devel

$ tar -xzf gearman-1.1.2.tgz   # 下载地址：https://pecl.php.net/package/gearman
$ cd gearman-1.1.2
$ phpize
$ ./configure; make; make install        // 实际上是给 PHP 增加了个 gearman 的 extension: /usr/lib64/php/modules/gearman.so

# 增加 php 扩展
$ vi /etc/php.d/gearman.ini
; Enable gearman extension module
extension=gearman.so
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;三、启动-gearmand&quot;&gt;&lt;a href=&quot;#三、启动-gearmand&quot; class=&quot;headerlink&quot; title=&quot;三、启动 gearmand&quot;&gt;&lt;/a&gt;三、启动 gearmand&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# ( 如果使用默认参数，需要开启 IPV6)

# 可以设置成服务启动：
$ vi /etc/sysconfig/gearmand
    OPTIONS=&amp;quot;-L 0.0.0.0 --verbose=DEBUG&amp;quot;    --&amp;gt; 根据自己需求设置 --verbose

$ service gearmand start

$ gearmand -d --http-port 8090 -L 0.0.0.0 -p 4730

# 如果需要使用数据库
gearmand -d --http-port=8080 -L 0.0.0.0 -p 4730 --mysql-user=root --mysql-password=YOUR_PASS --mysql-db gearman

$ gearman -w -f wc -- wc -l    // 开启一个 worker（-w）, 监听一个函数 wc(-f wc)， 函数的内容为 wc -l

# 将 /etc/passwd 文件给函数 wc 进行处理
$ gearman -f wc &amp;lt; /etc/passwd

$ gearadmin --show-jobs
      --status
      --workers
      -- ...
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;1-Worker&quot;&gt;&lt;a href=&quot;#1-Worker&quot; class=&quot;headerlink&quot; title=&quot;1. Worker:&quot;&gt;&lt;/a&gt;1. Worker:&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php

$worker = new GearmanWorker();
$worker-&amp;gt;addServer();
$worker-&amp;gt;addFunction(&amp;quot;reverse&amp;quot;, &amp;quot;reverse_fn&amp;quot;);

while (1) {
    print &amp;quot;Waiting for job...\n&amp;quot;;
    $ret = $worker-&amp;gt;work();
    if($worker-&amp;gt;returnCode() != GEARMAN_SUCCESS) {
       break;
    }
}

function reverse_fn(GearmanJob $job) {
    $workload = $job-&amp;gt;workload();
    echo &amp;quot;Received job: &amp;quot;. $job-&amp;gt;handle(). &amp;quot;\n&amp;quot;;
    echo &amp;quot;Workload: $workload\n&amp;quot;;
    $result = strrev($workload);
    echo &amp;quot;Result: $result\n&amp;quot;;
    return $result;
}

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="cluster" scheme="http://blog.dongcj.com/categories/cluster/"/>
    
    
      <category term="gearman" scheme="http://blog.dongcj.com/tags/gearman/"/>
    
  </entry>
  
  <entry>
    <title>Parted,kpartx,losetup,sfdisk,e2fsck,resize2fs</title>
    <link href="http://blog.dongcj.com/linux/Parted,kpartx,losetup,sfdisk,e2fsck,resize2fs/"/>
    <id>http://blog.dongcj.com/linux/Parted,kpartx,losetup,sfdisk,e2fsck,resize2fs/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;虚拟机增加系统盘根分区大小方法&quot;&gt;&lt;a href=&quot;#虚拟机增加系统盘根分区大小方法&quot; class=&quot;headerlink&quot; title=&quot;虚拟机增加系统盘根分区大小方法&quot;&gt;&lt;/a&gt;虚拟机增加系统盘根分区大小方法&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# 此方法适用于分区后连接的空间 , 如果是 swap, 将其删除，并在最末尾建 swap )

# 先增加实例文件大小，可以使用 dd 命令
$ dd if=/dev/zero of=/tmp/temp_expand bs=1M count=4096（增加 4 GB）
$ cat /tmp/temp_expand &amp;gt;&amp;gt;/var/lib/libvirt/images/my_vm.img

# 挂载文件至系统，以便找出是否有 swap device
$ kpartx -a -p p /var/lib/libvirt/images/my_vm.img

# If has swap device, del the swap device
$ swapDevice=`sfdisk -s -l /dev/loop0 | grep -e &amp;apos;Linux swap&amp;apos; |awk &amp;apos;{print $1}&amp;apos;`

# Del swap
$ parted -s ${loop} rm ${swap_part_num}

# If does&amp;apos;t have, add the new swap device
$ parted -s /dev/loop1 &amp;quot;unit mb mkpart primary linux-swap -2048MB -0&amp;quot;

# 或者先只划分空间，再用 mkswap 进行操作
# 可选的：
$ mkswap -v1 /dev/mapper/loop1p3

# 重新刷新新增加的 swap 设备
$ kpartx -d -p p /var/lib/libvirt/images/my_vm.img
$ kpartx -a -p p /var/lib/libvirt/images/my_vm.img

# 将新的 lo 设备分区进行打印
$ sfdisk -d /dev/loop0 &amp;gt;/tmp/sfdisk_dump

# 如果有 swap 分区，则 root 分区为 (root start), (swap start - root start)；如果没有 , 则为 (root start),
  new_root=401625,14227239        ( 样例，要修改 )
  converted_root_device=`echo &amp;quot;/dev/loop0p1&amp;quot; | sed -e &amp;apos;s/\//\\\\\//g&amp;apos;`
$ sed -e &amp;quot;s/^${converted_root_device}.*$/$new_root/&amp;quot; /tmp/sfdisk_dump | sfdisk --no-reread --force /dev/loop1

# 重新刷新新变更的分区
$ kpartx -d -p p /var/lib/libvirt/images/my_vm.img
$ kpartx -a -p p /var/lib/libvirt/images/my_vm.img

# fs resize
$ e2fsck -pv /dev/mapper/loop0p1
$ resize2fs -f /dev/mapper/loop0p1
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;parted-使用&quot;&gt;&lt;a href=&quot;#parted-使用&quot; class=&quot;headerlink&quot; title=&quot;parted 使用&quot;&gt;&lt;/a&gt;parted 使用&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;# create all 100% space to one part
$ parted -s /dev/sdb mklabel gpt
$ parted -a optimal -s /dev/sdb &amp;quot;mkpart primary 0% 100%&amp;quot;

# create other part
parted -a optimal -s /dev/sdb &amp;quot;mkpart logical 59G 459G&amp;quot;
parted -a optimal -s /dev/sdb &amp;quot;mkpart logical 459G 859G&amp;quot;

# remove part
parted -s /dev/sdb rm 2
parted -s /dev/sdb rm 3
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;分区对齐&quot;&gt;&lt;a href=&quot;#分区对齐&quot; class=&quot;headerlink&quot; title=&quot;分区对齐&quot;&gt;&lt;/a&gt;分区对齐&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;$ cat /sys/block/sdb/queue/optimal_io_size
  1048576
$ cat /sys/block/sdb/queue/minimum_io_size
  262144
$ cat /sys/block/sdb/alignment_offset
  0
$ cat /sys/block/sdb/queue/physical_block_size
  512

$ mkpart primary 2048s 100%

(parted) align-check optimal 1
  1 aligned
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="parted" scheme="http://blog.dongcj.com/tags/parted/"/>
    
      <category term="kpartx" scheme="http://blog.dongcj.com/tags/kpartx/"/>
    
      <category term="losetup" scheme="http://blog.dongcj.com/tags/losetup/"/>
    
      <category term="sfdisk" scheme="http://blog.dongcj.com/tags/sfdisk/"/>
    
      <category term="e2fsck" scheme="http://blog.dongcj.com/tags/e2fsck/"/>
    
      <category term="resize2fs" scheme="http://blog.dongcj.com/tags/resize2fs/"/>
    
  </entry>
  
  <entry>
    <title>Postgresql 主从配置</title>
    <link href="http://blog.dongcj.com/database/Postgresql%E4%B8%BB%E4%BB%8E%E9%85%8D%E7%BD%AE/"/>
    <id>http://blog.dongcj.com/database/Postgresql主从配置/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;安装好二台-postgresql&quot;&gt;&lt;a href=&quot;#安装好二台-postgresql&quot; class=&quot;headerlink&quot; title=&quot;安装好二台 postgresql&quot;&gt;&lt;/a&gt;安装好二台 postgresql&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;参见：&lt;a href=&quot;http://blog.dongcj.com/database/Postgresql%E5%AE%89%E8%A3%85/&quot;&gt;http://blog.dongcj.com/database/Postgresql%E5%AE%89%E8%A3%85/&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 主服务器上&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi /etc/profile&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; PGDATA=/pgdata&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; /etc/profile&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi /etc/profile&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; PGDATA=/pgdata_backup&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; /etc/profile&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;配置主服务器-192-168-10-11&quot;&gt;&lt;a href=&quot;#配置主服务器-192-168-10-11&quot; class=&quot;headerlink&quot; title=&quot;配置主服务器 192.168.10.11&quot;&gt;&lt;/a&gt;配置主服务器 192.168.10.11&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 使用 root 帐户&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mkdir /pgdata&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chown -R postgres:postgres /pgdata/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;su - postgres&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;psql [ -p  54321 ]     &lt;span class=&quot;comment&quot;&gt;# 如果修改过端口，需要指定端口&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;psql$ CREATE ROLE replica login replication encrypted password &lt;span class=&quot;string&quot;&gt;&#39;replica&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 增加 replica 用户&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /pgdata&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi pg_hba.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  host    replication     replica       192.168.10.12/32               md5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 配置复制参数&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi postgresql.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  wal_level = hot_standby     &lt;span class=&quot;comment&quot;&gt;# 主为 wal 的主机&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  max_wal_senders = 32        &lt;span class=&quot;comment&quot;&gt;# 最多几个流复制&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  wal_keep_segments = 256     &lt;span class=&quot;comment&quot;&gt;# 设置流复制保留最多的 log 数目，每个 log 16M&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  wal_sender_timeout = 60s    &lt;span class=&quot;comment&quot;&gt;# 流复制主机发送数据的超时时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  max_connections = 100       &lt;span class=&quot;comment&quot;&gt;# 注意：从库的 max_connections 必须要大于主库的&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 修改权限&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chmod -R 700 /pgdata/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 重启 pg&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pg_ctl restart&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;配置从服务器-192-168-10-12&quot;&gt;&lt;a href=&quot;#配置从服务器-192-168-10-12&quot; class=&quot;headerlink&quot; title=&quot;配置从服务器 192.168.10.12&quot;&gt;&lt;/a&gt;配置从服务器 192.168.10.12&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 使用 root 帐户&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mkdir /pgdata_backup&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chown -R postgres:postgres /pgdata_backup/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;su - postgres&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pg_basebackup -F p --progress -D /pgdata_backup -h 192.168.10.11 -p 5432 -U replica --password&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# password is: replica&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /pgdata_backup&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 编辑配置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi recovery.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果找不到 recovery.conf，可以新建，只需要下面三行即可&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;recovery_target_timeline = &lt;span class=&quot;string&quot;&gt;&#39;latest&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;standby_mode = on&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;primary_conninfo = &lt;span class=&quot;string&quot;&gt;&#39;host=192.168.10.11 port=5432 user=replica password=replica&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 编辑配置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;vi postgresql.conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;max_connections = 1000  &lt;span class=&quot;comment&quot;&gt;# ( 要大于主库的 )&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;hot_standby = on        &lt;span class=&quot;comment&quot;&gt;# 说明这台机器不仅仅是用于数据归档，也用于数据查询&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;max_standby_streaming_delay = 30s   &lt;span class=&quot;comment&quot;&gt;# 多久向主报告一次从的状态，最长的间隔时间&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;wal_receiver_status_interval = 5s   &lt;span class=&quot;comment&quot;&gt;# 间隔多久将状态信息发送给主&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;hot_standby_feedback = on           &lt;span class=&quot;comment&quot;&gt;# 如果有错误的数据复制，是否向主进行反馈&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;chmod -R 700 /pgdata_backup/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 启动从 pg&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;pg_ctl start&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;# 在主上应该有 sender 进程，在从上有 receiver 进程

$ psql$ select * from pg_stat_replication;
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;主从切换命令&quot;&gt;&lt;a href=&quot;#主从切换命令&quot; class=&quot;headerlink&quot; title=&quot;主从切换命令&quot;&gt;&lt;/a&gt;主从切换命令&lt;/h1&gt;&lt;p&gt;[postgres@node1 ~]$ pg_ctl stop -m f&lt;/p&gt;
&lt;p&gt;[postgres@node2 ~]$ pg_ctl promote&lt;/p&gt;
    
    </summary>
    
      <category term="database" scheme="http://blog.dongcj.com/categories/database/"/>
    
    
      <category term="postgresql" scheme="http://blog.dongcj.com/tags/postgresql/"/>
    
      <category term="pg recovery" scheme="http://blog.dongcj.com/tags/pg-recovery/"/>
    
  </entry>
  
  <entry>
    <title>斐讯 K2 路由器刷机</title>
    <link href="http://blog.dongcj.com/linux/%E6%96%90%E8%AE%AFK2%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%B7%E6%9C%BA/"/>
    <id>http://blog.dongcj.com/linux/斐讯K2路由器刷机/</id>
    <published>2016-08-11T07:43:19.000Z</published>
    <updated>2016-08-11T07:44:39.000Z</updated>
    
    <summary type="html">
    
      &lt;h1 id=&quot;买个-SS-帐号&quot;&gt;&lt;a href=&quot;#买个-SS-帐号&quot; class=&quot;headerlink&quot; title=&quot;买个 SS 帐号&quot;&gt;&lt;/a&gt;买个 SS 帐号&lt;/h1&gt;&lt;p&gt;不要问我 SS 是什么，我只能告诉你它是现在最好的 fun 墙工具！一般 400 左右一年，但每个商家质量千差万别，买前最好问清楚有没有流量限制，可以用几台客户端等，最好有老司机带路。&lt;/p&gt;
&lt;h1 id=&quot;路由刷机&quot;&gt;&lt;a href=&quot;#路由刷机&quot; class=&quot;headerlink&quot; title=&quot;路由刷机&quot;&gt;&lt;/a&gt;路由刷机&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;路由器通电，网线一端连接 “ 自己电脑的网口 “，一头连接路由器的 “LAN” 口，&lt;code&gt;注意：不是 WAN 口&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;查看自己电脑的 “ 网络连接 “，选中 “ 本地连接 “，点击右键，选择 “ 状态 “ -&amp;gt; “ 详细信息 “ 查看自己的 IP 地址&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;http://i.imgur.com/qlfwJ9j.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自己电脑中打开浏览器：&lt;a href=&quot;http://192.168.1.1&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://192.168.1.1&lt;/a&gt; ( 一般是 192.168.1.1 这个 IP 地址，IP 前三位和 “ 本地连接 “ 中看到的 IP 一致，但最后一位修改为 1 )&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用户名和密码默认 “admin/admin”&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;登陆 WEB 后，点击菜单 “ 系统 “ -&amp;gt; “ 升级 “( 其实我们是先降级，因为斐讯的默认系统是不让刷机的 )。然后浏览本地 “breed_k2_163_v17_breed.bin” 文件&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

    
    </summary>
    
      <category term="linux" scheme="http://blog.dongcj.com/categories/linux/"/>
    
    
      <category term="刷机" scheme="http://blog.dongcj.com/tags/%E5%88%B7%E6%9C%BA/"/>
    
      <category term="斐讯 K2" scheme="http://blog.dongcj.com/tags/%E6%96%90%E8%AE%AF-K2/"/>
    
      <category term="翻墙" scheme="http://blog.dongcj.com/tags/%E7%BF%BB%E5%A2%99/"/>
    
  </entry>
  
</feed>
